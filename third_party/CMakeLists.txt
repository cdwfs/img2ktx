cmake_minimum_required(VERSION 2.8)

# Suppress all warnings from external projects.
IF(${MSVC})
    SET_PROPERTY(DIRECTORY APPEND PROPERTY COMPILE_OPTIONS /W0)
    SET(CMAKE_CXX_FLAGS_RELEASE "/MP /MD" CACHE TYPE STRING FORCE)
    SET(CMAKE_CXX_FLAGS_DEBUG   "/MP /MDd" CACHE TYPE STRING FORCE)
    SET(CMAKE_C_FLAGS_RELEASE "/MP /MD" CACHE TYPE STRING FORCE)
    SET(CMAKE_C_FLAGS_DEBUG   "/MP /MDd" CACHE TYPE STRING FORCE)
ELSEIF(${UNIX})
    SET_PROPERTY(DIRECTORY APPEND PROPERTY COMPILE_OPTIONS -w)
ENDIF()

# Compressonator
# The stock Compressonator CMakeLists pulls in a ton of dependencies that aren't
# needed for texture compression, so we pretty much ignore it and grab only what
# we need here.
SET(COMPRESSONATOR_SOURCE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/Compressonator/Compressonator/Source)
SET(COMPRESSONATOR_INCLUDE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/Compressonator/Compressonator/Header)
SET(COMPRESSONATOR_CODEC_SOURCES
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ASTC/ARM/mathlib.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ASTC/ARM/softfloat.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ASTC/ASTC_Decode.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ASTC/ASTC_Encode.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ASTC/ASTC_Encode_Kernel.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ASTC/ASTC_Host.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ASTC/ASTC_Library.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ASTC/Codec_ASTC.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ATC/Codec_ATC.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ATC/Codec_ATC_RGB.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ATC/Codec_ATC_RGBA_Explicit.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ATC/Codec_ATC_RGBA_Interpolated.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ATI/Codec_ATI1N.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ATI/Codec_ATI2N.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ATI/Codec_ATI2N_DXT5.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ATI/Codec_ATI_TC.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ATI/Compressonatori_tc.c
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ATI/CompressonatorXCodec.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC6H/BC6H_Decode.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC6H/BC6H_Definitions.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC6H/BC6H_Encode.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC6H/BC6H_Library.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC6H/BC6H_utils.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC6H/Codec_BC6H.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC7/3dquant_vpc.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC7/BC7_Decode.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC7/BC7_Definitions.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC7/BC7_Encode.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC7/BC7_Library.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC7/BC7_Partitions.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC7/BC7_utils.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC7/Codec_BC7.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC7/reconstruct.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/BC7/shake.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Block/Codec_Block.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Block/Codec_Block_4x4.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Block/Codec_Block_8x8.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/Codecbuffer.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_Block.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_R16.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_R16F.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_R32.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_R32F.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_R8.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RG16.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RG16F.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RG32.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RG32F.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RG8.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RGB888.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RGB9995EF.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RGBA16.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RGBA16F.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RGBA2101010.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RGBA32.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RGBA32F.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Buffer/CodecBuffer_RGBA8888.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/Codec.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXT/Codec_DXT1.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXT/Codec_DXT3.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXT/Codec_DXT5.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXT/Codec_DXT5_RBxG.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXT/Codec_DXT5_RGxB.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXT/Codec_DXT5_RxBG.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXT/Codec_DXT5_Swizzled.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXT/Codec_DXT5_xGBR.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXT/Codec_DXT5_xGxR.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXT/Codec_DXT5_xRBG.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXTC/Codec_DXTC.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXTC/Codec_DXTC_Alpha.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXTC/Codec_DXTC_RGBA.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXTC/dxtc_v11_compress.c
    #${COMPRESSONATOR_SOURCE_DIR}/Codec/DXTC/dxtc_v11_compress_64.asm
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/DXTC/dxtc_v11_compress_asm.c
    #${COMPRESSONATOR_SOURCE_DIR}/Codec/DXTC/dxtc_v11_compress_sse2.asm
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ETC/Codec_ETC.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ETC/Codec_ETC2.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ETC/Codec_ETC2_RGB.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ETC/Codec_ETC2_RGBA.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ETC/Codec_ETC2_RGBA1.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ETC/Codec_ETC_RGB.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ETC/Codec_ETC_RGBA_Explicit.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ETC/Codec_ETC_RGBA_Interpolated.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ETC/etc.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ETC/etcpack/etcdec.cxx
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ETC/etcpack/etcimage.cxx
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/ETC/etcpack/etcpack.cxx
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/GT/Codec_GT.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/GT/Codec_GTCH.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/GT/GTCH_Decode.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/GT/GTCH_Encode.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/GT/GT_Decode.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Codec/GT/GT_Encode.cpp
)
SET(COMPRESSONATOR_CODEC_HEADERS
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ASTC/ARM/astc_codec_internals.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ASTC/ARM/mathlib.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ASTC/ARM/softfloat.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ASTC/ARM/vectypes.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ASTC/ASTC_Decode.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ASTC/ASTC_Definitions.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ASTC/ASTC_Encode.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ASTC/ASTC_Encode_Kernel.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ASTC/ASTC_Host.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ASTC/ASTC_Library.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ASTC/Codec_ASTC.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ATC/Codec_ATC.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ATC/Codec_ATC_RGB.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ATC/Codec_ATC_RGBA_Explicit.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ATC/Codec_ATC_RGBA_Interpolated.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ATI/Codec_ATI1N.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ATI/Codec_ATI2N.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ATI/Codec_ATI2N_DXT5.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ATI/CompressonatorXCodec.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ATI/Compressonator_tc.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC6H/BC6H_Decode.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC6H/BC6H_Definitions.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC6H/BC6H_Encode.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC6H/BC6H_Library.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC6H/BC6H_utils.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC6H/Codec_BC6H.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC7/3dquant_constants.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC7/3dquant_vpc.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC7/BC7_Decode.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC7/BC7_Definitions.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC7/BC7_Encode.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC7/BC7_Library.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC7/BC7_Partitions.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC7/BC7_utils.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC7/Codec_BC7.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC7/reconstruct.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/BC7/shake.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Block/Codec_Block.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Block/Codec_Block_4x4.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Block/Codec_Block_8x8.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_Block.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_R16.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_R16F.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_R32.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_R32F.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_R8.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RG16.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RG16F.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RG32.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RG32F.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RG8.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RGB888.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RGB9995EF.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RGBA16.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RGBA16F.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RGBA2101010.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RGBA32.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RGBA32F.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Buffer/CodecBuffer_RGBA8888.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/Codec.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/DXT/Codec_DXT1.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/DXT/Codec_DXT3.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/DXT/Codec_DXT5.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/DXT/Codec_DXT5_RBxG.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/DXT/Codec_DXT5_RGxB.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/DXT/Codec_DXT5_RxBG.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/DXT/Codec_DXT5_Swizzled.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/DXT/Codec_DXT5_xGBR.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/DXT/Codec_DXT5_xGxR.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/DXT/Codec_DXT5_xRBG.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/DXTC/Codec_DXTC.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/DXTC/dxtc_v11_compress.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ETC/Codec_ETC.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ETC/Codec_ETC2.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ETC/Codec_ETC2_RGB.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ETC/Codec_ETC2_RGBA.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ETC/Codec_ETC2_RGBA1.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ETC/Codec_ETC_RGB.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ETC/Codec_ETC_RGBA_Explicit.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ETC/Codec_ETC_RGBA_Interpolated.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ETC/etcpack/etcimage.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ETC/etcpack/etcpack_lib.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/ETC/etcpack.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/GT/Codec_GT.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/GT/Codec_GTCH.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/GT/GTCH_Decode.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/GT/GTCH_Encode.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/GT/GT_Decode.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/GT/GT_Definitions.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Codec/GT/GT_Encode.h
)
SET(COMPRESSONATOR_SOURCES
    ${COMPRESSONATOR_CODEC_SOURCES}
    ${COMPRESSONATOR_SOURCE_DIR}/Common/HDR_Encode.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Compress.cpp
    ${COMPRESSONATOR_SOURCE_DIR}/Compressonator.cpp
)
SET(COMPRESSONATOR_HEADERS
    ${COMPRESSONATOR_CODEC_HEADERS}
    ${COMPRESSONATOR_SOURCE_DIR}/Common/Common_Def.h
    ${COMPRESSONATOR_SOURCE_DIR}/Common/Common_Kernel.h
    ${COMPRESSONATOR_SOURCE_DIR}/Common/Common_KernelDef.h
    ${COMPRESSONATOR_SOURCE_DIR}/Common/HDR_Encode.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Internal/debug.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Common.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Compress.h
    ${COMPRESSONATOR_INCLUDE_DIR}/Compressonator.h
    ${COMPRESSONATOR_INCLUDE_DIR}/MathMacros.h
)
# The dependency on OpenEXR is solely to use the Half implementation in ilmbase.
# I wish there were a better way to avoid cloning 100s of MB for ~1MB of code.
SET(COMPRESSONATOR_OPENEXR_DIR ${CMAKE_CURRENT_SOURCE_DIR}/FakeOpenEXR CACHE PATH "Base directory for OpenEXR")
LIST(APPEND COMPRESSONATOR_HEADERS "${COMPRESSONATOR_OPENEXR_DIR}/ilmbase-2.2.0/Half/half.h")
LIST(APPEND COMPRESSONATOR_SOURCES "${COMPRESSONATOR_OPENEXR_DIR}/ilmbase-2.2.0/Half/half.cpp")

SET(COMPRESSONATOR_INCLUDE_DIRS "")
FOREACH(_headerFile ${COMPRESSONATOR_HEADERS})
    GET_FILENAME_COMPONENT(_dir ${_headerFile} PATH)
    LIST(APPEND COMPRESSONATOR_INCLUDE_DIRS ${_dir})
ENDFOREACH()
LIST(REMOVE_DUPLICATES COMPRESSONATOR_INCLUDE_DIRS)
    
ADD_LIBRARY(Compressonator STATIC
    ${COMPRESSONATOR_SOURCES}
    ${COMPRESSONATOR_HEADERS}
)
TARGET_INCLUDE_DIRECTORIES(Compressonator
    PUBLIC ${COMPRESSONATOR_INCLUDE_DIR}
    PRIVATE ${COMPRESSONATOR_INCLUDE_DIRS}
)

IF(${CMAKE_SYSTEM_NAME} MATCHES "Windows")
# "TESTCODE" in this context means SIMDified DXTC compression code.
# It is disabled by default in the Compressonator project, so I will do the same here.
TARGET_COMPILE_DEFINITIONS(Compressonator PRIVATE DISABLE_TESTCODE)
ENDIF()

IF(${CMAKE_SYSTEM_NAME} STREQUAL "Linux" OR ${CMAKE_SYSTEM_NAME} STREQUAL "Darwin")
TARGET_COMPILE_DEFINITIONS(Compressonator PRIVATE _LINUX)
ENDIF()
